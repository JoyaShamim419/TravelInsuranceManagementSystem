@model TravelInsuranceManagementSystem.Repo.Models.UserDashboardViewModel

@{

    ViewData["Title"] = "User Dashboard";

    Layout = "~/Views/Shared/_UserDashboardLayout.cshtml";

}

@section Styles {
    <style>

        .kpi-card {
            border: 1px solid #d7d7d7;
            border-radius: .75rem;
            box-shadow: 0 2px 6px rgba(0,0,0,0.06);
        }

        .chip {
            display: inline-flex;
            align-items: center;
            gap: .5rem;
            background: linear-gradient(135deg, #f7b980, #ed985f);
            color: #001f3d;
            padding: .35rem .6rem;
            border-radius: 1rem;
            font-weight: 600;
            font-size: .8rem;
        }

        .panel {
            background: #ffffff;
            border: 1px solid #d7d7d7;
            border-radius: .75rem;
            box-shadow: 0 2px 6px rgba(0,0,0,0.06);
        }

        .status {
            border-radius: 1rem;
            padding: .2rem .55rem;
            font-weight: 600;
            font-size: .8rem;
        }

        .status-approved {
            background: #d2f6d6;
            color: #0b5c19;
        }

        .status-pending {
            background: #fff2cc;
            color: #7a5b00;
        }

        .status-rejected {
            background: #ffd9d6;
            color: #7a0b00;
        }
    </style>

}

<h1 class="fw-bold" style="color:#001f3d;">User Dashboard</h1>

<div class="row g-3 mb-3">
    <div class="col-12 col-md-6 col-xl-3">
        <div class="card kpi-card p-3">
            <div class="small text-muted">Active Policies</div>
            <div class="h5 fw-bold text-dark">@Model.ActivePolicies</div>
            <span class="chip mt-2">In Good Standing</span>
        </div>
    </div>
    <div class="col-12 col-md-6 col-xl-3">
        <div class="card kpi-card p-3">
            <div class="small text-muted">Open Claims</div>
            <div class="h5 fw-bold text-dark">@Model.OpenClaims</div>
            <span class="chip mt-2">Action Required</span>
        </div>
    </div>
    <div class="col-12 col-md-6 col-xl-3">
        <div class="card kpi-card p-3">
            <div class="small text-muted">Tickets Raised</div>
            <div class="h5 fw-bold text-dark">@Model.Tickets</div>
            <span class="chip mt-2">Support</span>
        </div>
    </div>
    <div class="col-12 col-md-6 col-xl-3">
        <div class="card kpi-card p-3">
            <div class="small text-muted">Upcoming Trips</div>
            <div class="h5 fw-bold text-dark">@Model.UpcomingTrips</div>
            <span class="chip mt-2">Plan Ahead</span>
        </div>
    </div>
</div>

<div class="row g-3">
    <div class="col-12 col-xl-12">
        <div class="panel p-3">
            <h5 class="mb-3" style="color:#001f3d;">Recent Activity</h5>
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead class="table-light">
                        <tr>
                            <th>Type</th>
                            <th>Reference ID</th>
                            <th>Description</th>
                            <th>Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>

                        @if (Model.RecentActivities != null && Model.RecentActivities.Any())

                        {

                            foreach (var item in Model.RecentActivities)

                            {
                                <tr>
                                    <td>

                                        @if (item.Type == "Policy")
                                        {
                                            <span class="fw-bold text-primary">Policy</span>
                                        }

                                        else if (item.Type == "Claim")
                                        {

                                            <span class="fw-bold text-warning">Claim</span>
                                        }

                                        else
                                        {

                                            <span class="fw-bold text-secondary">Ticket</span>
                                        }
                                    </td>
                                    <td>@item.ReferenceId</td>
                                    <td>@item.Description</td>
                                    <td>@item.Date.ToString("yyyy-MM-dd")</td>
                                    <td><span class="status @item.StatusColor">@item.Status</span></td>
                                </tr>

                            }

                        }

                        else

                        {
                            <tr>
                                <td colspan="5" class="text-center text-muted">No recent activity found.</td>
                            </tr>

                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
